    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric))
library(purrr)
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0)))
library(tidyr)
library(purrr)
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0)))
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0)))
  group_by(date) %>%
  summarize_all(max)
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0)))
  group_by(date) %>%
  summarize_all(max)
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0))) %>%
  group_by(date) %>%
  summarize_all(max)
df3 <- df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude, na.rm = TRUE)) %>%
  ungroup() %>%
  select(date, total_goals) %>%
  mutate(week_of_year = lubridate::week(date),
         day_of_week = lubridate::wday(date, label = TRUE)) 
df3 <- df2 %>%
df3 <- df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude)) %>%
  ungroup() %>%
  select(date, total_goals) %>%
  mutate(week_of_year = lubridate::week(date),
         day_of_week = lubridate::wday(date, label = TRUE)) 
df3 <- df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude)) %>%
  ungroup() %>%
  select(date, total_goals) %>%
  mutate(week_of_year = lubridate::week(date),
         day_of_week = lubridate::wday(date, label = TRUE)) 
df3
df
df %>% query(is.na(date))
df %>% filter(is.na(date))
df2
df
df$date
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0))) %>%
  group_by(date) %>%
  summarize_all(max)
df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude))
df2
df2
df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0))) %>%
  group_by(date) %>%
  summarize_all(max)
df2 <- df %>%
  select(
    date, pray, meditate, cardio, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0))) %>%
  group_by(date) %>%
  summarize_all(max)
df2
df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude)) %>%
  ungroup() %>%
  select(date, total_goals) %>%
  mutate(week_of_year = lubridate::week(date),
         day_of_week = lubridate::wday(date, label = TRUE)) 
df2
df2 <- df %>%
  select(
    date, pray, meditate, cardio, strength, post_cfm_study, post_gratitude
  ) %>% 
  mutate(across(-date, as.numeric)) %>%
  mutate(across(-date, ~replace_na(., 0))) %>%
  group_by(date) %>%
  summarize_all(max)
df2
df3 <- df2 %>% 
  rowwise() %>%
  mutate(total_goals = sum(pray, meditate, strength, cardio, post_cfm_study, post_gratitude)) %>%
  ungroup() %>%
  select(date, total_goals) %>%
  mutate(week_of_year = lubridate::week(date),
         day_of_week = lubridate::wday(date, label = TRUE)) 
df3
ggplot(df3, aes(x = week_of_year, y = day_of_week, fill = total_goals)) +
  geom_tile(color = "white", width = 0.9, height = 0.9) +  # Adjust these values as needed to shrink the tiles
  scale_fill_gradient(low = "white", high = "darkgreen", limits = c(1, 6)) +
  labs(x = "Week of the Year", y = "Day of Week", fill='Count') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.ticks = element_blank())
df2_recent <- df2 %>% 
  filter(date >= max(date) - 13) %>%
  arrange(desc(date)) %>%
  select(
    `Day` = date,
    `ğŸ›` = pray,
    `ğŸ§˜ğŸ¼â€â™‚ï¸` = meditate,
    `ğŸ“–` = post_cfm_study,
    `ğŸ™ğŸ»` = post_gratitude,
    `ğŸš´ğŸ»â€â™‚ï¸` = cardio,
    `ğŸ‹ğŸ¼â€â™‚ï¸` = strength
  ) 
df2_recent <- df2 %>% 
  filter(date >= max(date) - 13) %>%
  arrange(desc(date)) %>%
  select(
    `Day` = date,
    `ğŸ›` = pray,
    `ğŸ§˜ğŸ¼â€â™‚ï¸` = meditate,
    `ğŸ“–` = post_cfm_study,
    `ğŸ™ğŸ»` = post_gratitude,
    `ğŸš´ğŸ»â€â™‚ï¸` = cardio,
    `ğŸ‹ğŸ¼â€â™‚ï¸` = strength
  ) 
df2_recent
# Assuming your data frame is named 'data'
# First, convert the 'Day' column to the desired format
df2_recent$Day <- format(as.Date(df2_recent$Day), "%a %b %d")
df2_recent %>%
  gt(id='mygt', rowname_col = "Day") %>%
  data_color(
    columns = c(2:7),  # replace with the actual column indices or names
    colors = scales::col_bin(
      bins = c(-Inf, 0.5, Inf),  # defining bins to separate 0 and 1
      palette = c("white", "darkgreen", "blue"),  # white for 0, dark green for 1
      domain = NULL
    )
  ) %>%
  tab_header(
    title = "Daily Habits"
  ) |>
  tab_style(
    style = list(
      cell_text(color = "transparent")
    ),
    locations = cells_body(
      columns = c(2:7)  # replace with the actual column indices or names
    )
  ) %>%
  cols_align(align = "center") %>%
  tab_style(
    style = cell_borders(sides = "right", color = "white", weight = px(1)),
    locations = cells_body(columns = everything())
  ) %>%
  cols_width(
    Day ~ px(100),
    everything() ~ px(50),
  ) 
library(gt)
df2_recent <- df2 %>% 
  filter(date >= max(date) - 13) %>%
  arrange(desc(date)) %>%
  select(
    `Day` = date,
    `ğŸ›` = pray,
    `ğŸ§˜ğŸ¼â€â™‚ï¸` = meditate,
    `ğŸ“–` = post_cfm_study,
    `ğŸ™ğŸ»` = post_gratitude,
    `ğŸš´ğŸ»â€â™‚ï¸` = cardio,
    `ğŸ‹ğŸ¼â€â™‚ï¸` = strength
  ) 
# Assuming your data frame is named 'data'
# First, convert the 'Day' column to the desired format
df2_recent$Day <- format(as.Date(df2_recent$Day), "%a %b %d")
df2_recent %>%
  gt(id='mygt', rowname_col = "Day") %>%
  data_color(
    columns = c(2:7),  # replace with the actual column indices or names
    colors = scales::col_bin(
      bins = c(-Inf, 0.5, Inf),  # defining bins to separate 0 and 1
      palette = c("white", "darkgreen", "blue"),  # white for 0, dark green for 1
      domain = NULL
    )
  ) %>%
  tab_header(
    title = "Daily Habits"
  ) |>
  tab_style(
    style = list(
      cell_text(color = "transparent")
    ),
    locations = cells_body(
      columns = c(2:7)  # replace with the actual column indices or names
    )
  ) %>%
  cols_align(align = "center") %>%
  tab_style(
    style = cell_borders(sides = "right", color = "white", weight = px(1)),
    locations = cells_body(columns = everything())
  ) %>%
  cols_width(
    Day ~ px(100),
    everything() ~ px(50),
  ) 
df2_recent %>%
  gt(id='mygt', rowname_col = "Day") %>%
  data_color(
    columns = c(2:7),  # replace with the actual column indices or names
    colors = scales::col_bin(
      bins = c(-Inf, 0.5, Inf),  # defining bins to separate 0 and 1
      palette = c("white", "darkgreen"),  # white for 0, dark green for 1
      domain = NULL
    )
  ) %>%
  tab_header(
    title = "Daily Habits"
  ) |>
  tab_style(
    style = list(
      cell_text(color = "transparent")
    ),
    locations = cells_body(
      columns = c(2:7)  # replace with the actual column indices or names
    )
  ) %>%
  cols_align(align = "center") %>%
  tab_style(
    style = cell_borders(sides = "right", color = "white", weight = px(1)),
    locations = cells_body(columns = everything())
  ) %>%
  cols_width(
    Day ~ px(100),
    everything() ~ px(50),
  ) 
df
df2
df %>% 
  select(date, `pelo-time`)
df %>% 
  filter(!is.na(cardio))
df %>% 
  mutate(
    post_cfm_study = stringr::str_detect(categories, 'come follow me'),
    post_gratitude = folder == 'gratitude',
    pelo = ifelse(`pelo-time` > 0, 1, 0),
    cardio = ifelse(`pelo-time` > 0 | `run-dist` > 0 | `hike-dist` > 0, 1, 0),
    strength = ifelse(length(exercises) >=1, 1, 0)
  ) %>%
  filter(title != "test")
df <- df %>% 
  mutate(
    post_cfm_study = stringr::str_detect(categories, 'come follow me'),
    post_gratitude = folder == 'gratitude',
    pelo = ifelse(`pelo-time` > 0, 1, 0),
    cardio = ifelse(`pelo-time` > 0 | `run-dist` > 0 | `hike-dist` > 0, 1, 0),
    strength = ifelse(length(exercises) >=1, 1, 0)
  ) %>%
  filter(title != "test")
df %>% 
  filter(!is.na(cardio))
  select(date, `pelo-time`)
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60)
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60)
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`))
df$columns
colnames(df)
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`))
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date)
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`)
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  gt()
df %>% 
  filter(!is.na(pelo)) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  gt()
df <- df %>% 
  mutate(
    post_cfm_study = stringr::str_detect(categories, 'come follow me'),
    post_gratitude = folder == 'gratitude',
    pelo = ifelse(`pelo-time` > 0, 1, 0),
    cardio = ifelse(`pelo-time` > 0 | `run-dist` > 0 | `hike-dist` > 0, 1, 0),
    strength = ifelse(length(exercises) >=1, 1, 0)
  ) %>%
  filter(title != "test")
df %>% 
  filter(pelo == 1)
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  gt()
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`80%` = .8 * `pelo-kj`)
252*(10*60)/1000
252*.8*(10*60)/1000
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)"))
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ (", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt()
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ<br>(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt()
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt()
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt() %>%
  cols_width(
    `80%` ~ px(50),
    everything() ~ px(150),
  ) 
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt() %>%
  cols_width(
    `90%` ~ px(70),
    `80%` ~ px(70),
    `70%` ~ px(70),
    # everything() ~ px(150),
  ) 
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt() %>%
  cols_width(
    `90%` ~ px(70),
    `80%` ~ px(70),
    `70%` ~ px(70),
    # everything() ~ px(150),
  ) %>%
  cols_label(
    `pelo-time` = "Time",
    `pelo-kj` = "KJ",
    `pelo-avg` = "Avg W"
  )
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt() %>%
  cols_width(
    `90%` ~ px(70),
    `80%` ~ px(70),
    `70%` ~ px(70),
    # everything() ~ px(150),
  ) %>%
  cols_label(
    `pelo-time` = "Time",
    `pelo-kj` = "KJ",
    `pelo-avg` = "Avg W",
    `workout-notes` = "Notes",
    `date` = `Day`
  )
df %>% 
  filter(pelo == 1) %>%
  filter(date >= Sys.Date() - 60) %>%
  group_by(`pelo-time`) %>%
  filter(`pelo-kj` == max(`pelo-kj`)) %>%
  select(`pelo-time`, `pelo-kj`, `pelo-avg`, date, `workout-notes`) %>%
  ungroup() %>%
  mutate(`90%` = paste0("", .9 * `pelo-kj`, "KJ\n(", .9 * `pelo-avg`, "avg)")) %>%
  mutate(`80%` = paste0("", .8 * `pelo-kj`, "KJ (", .8 * `pelo-avg`, "avg)")) %>%
  mutate(`70%` = paste0("", .7 * `pelo-kj`, "KJ (", .7 * `pelo-avg`, "avg)")) %>%
  gt() %>%
  cols_width(
    `90%` ~ px(70),
    `80%` ~ px(70),
    `70%` ~ px(70),
    # everything() ~ px(150),
  ) %>%
  cols_label(
    `pelo-time` = "Time",
    `pelo-kj` = "KJ",
    `pelo-avg` = "Avg W",
    `workout-notes` = "Notes",
    `date` = "Day"
  ) %>%
  tab_header(title = "Bike Records")
